28.03.2019
//Peipsi fail
> andmed=read.table(file.choose(),header=TRUE,sep="\t",dec=",")
> attach(andmed)

Peakomponentide meetod (PCA)
> R=cor(andmed)
> R
eigen(R)
Korrelatsioonimaatriks
             CY         BAC        CHL         DIP         DOP          SI         DIN
CY   1.00000000 -0.08799284  0.1749122  0.11020862  0.28916824 -0.06395347 -0.14522063
BAC -0.08799284  1.00000000  0.1084867  0.21238817  0.32236772 -0.07588529 -0.08039185
CHL  0.17491221  0.10848667  1.0000000  0.21148955  0.22207676  0.15451905 -0.14247427
DIP  0.11020862  0.21238817  0.2114896  1.00000000  0.85348278  0.18010935 -0.01246344
DOP  0.28916824  0.32236772  0.2220768  0.85348278  1.00000000  0.05789910 -0.05978229
SI  -0.06395347 -0.07588529  0.1545191  0.18010935  0.05789910  1.00000000  0.37233616
DIN -0.14522063 -0.08039185 -0.1424743 -0.01246344 -0.05978229  0.37233616  1.00000000
DON  0.23220660  0.19692814  0.1187537  0.43421555  0.51207935  0.06045528  0.05953655
           DON
CY  0.23220660
BAC 0.19692814
CHL 0.11875370
DIP 0.43421555
DOP 0.51207935
SI  0.06045528
DIN 0.05953655
DON 1.00000000

//Eigenvalue
> eigen(R)
Omaväärtused ja omavektorid
eigen() decomposition
$values
[1] 2.5401161 1.4480471 1.1212747 0.9783822 0.7239596 0.5715895 0.5074305 0.1092003

$vectors
            [,1]        [,2]        [,3]        [,4]        [,5]        [,6]        [,7]
[1,]  0.22644724 -0.26576449  0.63267145 -0.29388422  0.37767267 -0.47304942  0.02496592
[2,]  0.25300193 -0.12810125 -0.62724488  0.29266342  0.53495501 -0.35732264  0.11885142
[3,]  0.24793357 -0.06400002  0.37164042  0.75383527  0.16375461  0.29443883 -0.33839207
[4,]  0.53909937  0.11401608 -0.09664337 -0.03892083 -0.48428789 -0.09061609 -0.14309323
[5,]  0.57889850 -0.01655351 -0.07462843 -0.11387254 -0.23294953 -0.17843410 -0.16457858
[6,]  0.09391237  0.65486039  0.22717110  0.28422787 -0.04748132 -0.22617948  0.60904665
[7,] -0.04492293  0.68060433 -0.03935576 -0.22933742  0.35345121 -0.05547153 -0.59335341
[8,]  0.43203173  0.05937365 -0.01044868 -0.33443931  0.35831333  0.68378820  0.31650273
             [,8]
[1,] -0.156250100
[2,] -0.111848509
[3,]  0.005453114
[4,] -0.649842847
[5,]  0.729983447
[6,]  0.074811048
[7,] -0.023281448
[8,] -0.041662966

//Iga komponendi vastav hajuvus
> princomp(andmed)
Standard deviations:
     Comp.1      Comp.2      Comp.3      Comp.4      Comp.5      Comp.6      Comp.7      Comp.8 
6.066392877 3.815508172 0.649118001 0.213630682 0.183836513 0.140539199 0.025689216 0.005763323 

 8  variables and  156 observations.
 
//Esimene komponenet kirjeldab juba 70%
//Kahe peakomponendi abil juba 80% kirjeldatud
//Komponendi on omavahel risti/ortogonaalsed
> summary(princomp(andmed))
Importance of components:
                          Comp.1    Comp.2      Comp.3       Comp.4      Comp.5       Comp.6
Standard deviation     6.0663929 3.8155082 0.649118001 0.2136306817 0.183836513 0.1405391995
Proportion of Variance 0.7093446 0.2806086 0.008121636 0.0008796774 0.000651418 0.0003807073
Cumulative Proportion  0.7093446 0.9899532 0.998074837 0.9989545142 0.999605932 0.9999866394
                             Comp.7       Comp.8
Standard deviation     2.568922e-02 5.763323e-03
Proportion of Variance 1.272032e-05 6.402389e-07
Cumulative Proportion  9.999994e-01 1.000000e+00 

Graafik
> biplot(princomp(andmed))
Tekitab n.o peakomponentide siili
Lisaks veel
> screeplot(princomp(andmed))

Diskriminantanalüüs

Kaugused
> d=dist(andmed)

Klasterdamine
> klast=hclust(d,method="complete")
> plot(klast)
//iga objekti kaugus keskmisest

Juhusliku vektrori keskväärtus andmestiku baasil
> colMeans(andmed)
        CY        BAC        CHL        DIP        DOP         SI        DIN        DON 
3.29725641 5.23328205 0.21872436 0.01424359 0.05200000 0.92326923 0.14320513 0.55801282 


Mahalanobise kaugus
> kaug=mahalanobis(andmed, colMeans(andmed),cov=R)
> kaug
  [1]   38.407443   50.473855   35.287206   48.676556   54.009559   37.660200   21.964789
  [8]   30.787765   42.422023   17.392578   30.452429   13.573571    9.607686   45.699062
 [15]   14.628849   16.461913   16.044722   18.648835   20.056873   51.446547    7.883381
 [22]   17.666962   28.212786   13.560395   10.697319   16.780741   13.577460   51.721512
 [29]  764.692053   10.550898   19.960459    8.497278  249.558640   53.792998   46.276008
 [36]   50.687717   57.666078   59.214672   24.471399   13.850746   49.868317   13.051568
 [43]   49.146030   48.107575   55.058106   55.593337   50.315522   55.756255   26.680444
 [50]   15.087965   15.944646   10.141134   16.562615   32.190603   11.808136   20.115353
 [57]  793.651734  233.291591    6.891785    2.970387    5.452382  107.470506  131.302617
 [64]   37.283478   15.531003    5.403859   67.245746  290.418714 1074.195319  367.310603
 [71]  722.611441  738.599589   41.584435   33.613227   35.293751   50.669804   35.730911
 [78]   13.494809   12.223646   13.031428    6.493922   13.882580   30.421973    8.153237
 [85]   16.514365   73.842404   37.028935   14.899863   16.159493   15.833341  129.102029
 [92]   96.068583    2.289947   37.415167   36.288751   41.124368   87.253801    6.206384
 [99]    9.631042   73.340111   14.097228   36.066010   66.529896   17.397641    9.840216
[106]  175.717778    2.473722   10.710215   95.405857   37.706729   43.310954   29.333682
[113]   35.124670   32.586606   23.489320   20.151727   28.287259   28.864469    9.004189
[120]   35.374884   23.388115   33.131432   40.069529   33.791248   26.294685   15.664933
[127]   32.461025   22.353944    7.941529   19.216592   57.371007   40.339871   19.457334
[134]    5.161952   15.575234   27.949740   13.832132    8.618145    1.608865   86.083690
[141]   12.422045   10.314268   23.399183   21.265459   10.659154   30.061753    1.521487
[148]  179.733819    6.309108    4.374169    1.939155   22.953374   26.764574    8.321475
[155]   14.041019   23.482552


Programmeerimine keskkonnas R
Jaotuste segu modelleerimine

y=0
alfa=0.4
for (i in 1:1000) {
u=runif(1)
if (u<0.4) (y[i]=rexp(1)) else (y[i]=rnorm(1)) }

Juhusliku suuruse Y keskmine, mediaan ja dispersioon
> mean(y)
[1] 0.3934864
> var(y)
[1] 1.222173
> quantile(y)
        0%        25%        50%        75%       100% 
-3.2378524 -0.3070679  0.3621311  0.9707540  5.6487530 

Assümmeetria leidmine
> library(e1071)
> skewness(y)
[1] 0.4749899

y=0
alfa=0.6
for (i in 1:1000) {
u=runif(1)
if (u<alfa) (y[i]=rexp(1)) else (y[i]=rnorm(1)) }
> mean(y)
[1] 0.6018671
> skewness(y)
[1] 1.010328
> var(y)
[1] 1.415181


Maatriksite koostamine R-is

A = matrix( 
   c(1, -0.9, -0.2, -0.9, 1, 0.7, -0.2, 0.7, 1), # the data elements 
   nrow=3,              # number of rows 
   ncol=3,              # number of columns 
   byrow = TRUE)        # fill matrix by rows
   
> A
     [,1] [,2] [,3]
[1,]  1.0 -0.9 -0.2
[2,] -0.9  1.0  0.7
[3,] -0.2  0.7  1.0
> det(A)
[1] -0.088				#determinant on negatiivne seega antud maatriks on määramata

See maatriks A ei kõlba korrelatsioonimaatriksiks
A = matrix( 
   c(1, -0.8, -0.2, -0.8, 1, 0.7, -0.2, 0.7, 1), # the data elements 
   nrow=3,              # number of rows 
   ncol=3,              # number of columns 
   byrow = TRUE)        # fill matrix by rows
> A
     [,1] [,2] [,3]
[1,]  1.0 -0.8 -0.2
[2,] -0.8  1.0  0.7
[3,] -0.2  0.7  1.0
> det(A)
[1] 0.054				#sobib

See maatriks A kõlbab korrelatsioonimaatriksiks

Omaväärtus
> eigen(A)
eigen() decomposition
$values
[1] 2.16702248 0.80190270 0.03107482

$vectors
           [,1]        [,2]       [,3]
[1,]  0.5468434  0.65449657  0.5221078
[2,] -0.6733261 -0.02682969  0.7388587
[3,] -0.4975885  0.75558878 -0.4260180

Maatriks A pöördmaatriks
> solve(A)
          [,1]      [,2]       [,3]
[1,]  9.444444  12.22222  -6.666667
[2,] 12.222222  17.77778 -10.000000
[3,] -6.666667 -10.00000   6.666667


Kahe maatriksi korrutamine
> A%*%solve(A)
             [,1]          [,2] [,3]
[1,] 1.000000e+00 -4.440892e-16    0
[2,] 1.776357e-15  1.000000e+00    0
[3,] 0.000000e+00  1.776357e-15    1

> solve(A)%*%A
              [,1]          [,2]         [,3]
[1,]  1.000000e+00  2.664535e-15 8.881784e-16
[2,] -2.220446e-15  1.000000e+00 1.776357e-15
[3,]  8.881784e-16 -8.881784e-16 1.000000e+00







